var GeoText=function(e,t,n){"use strict";function r(t){this.vars={name:"default",delimiter:", "};this.data={success:false};if(t!==n){this.vars=e.extend(this.vars,t)}this.init()}r.prototype.init=function(){var e=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(r){var i=new t.LatLng(r.coords.latitude,r.coords.longitude);(new t.Geocoder).geocode({latLng:i},function(r,i){if(i===t.GeocoderStatus.OK&&r[0]!==n){e.setLocation(r[0])}})})}};r.prototype.setLocation=function(t){var n=this;n.data.success=true;e.each(t.address_components,function(t,r){e.each(r.types,function(e,t){n.data[t]=r.short_name;n.data[t+"_long"]=r.long_name})});n.applyText()};r.prototype.applyText=function(){var t=this;var n=e("[class*=geotext]");e.each(n,function(n,r){var i=e(r);var s=i.data("geotext-delimiter")||t.vars.delimiter;var o=t.parseField(i,s);if(o){if(i.data("geotext-text-before")){o=i.data("geotext-text-before")+o}if(i.data("geotext-text-after")){o=o+i.data("geotext-text-after")}if(i.is("input")){i.val(o).change()}else{i.html(o)}}})};r.prototype.parseField=function(t,r){var i=this;var s=/geotext\[(.*)\]/.exec(t.attr("class"));if(!s){return false}var o=s[1];var u=o.split(/\[|,|\]/);e.each(u,function(e,t){u[e]=t.replace(" ","");if(u[e]===""){delete u[e]}});var a="";e.each(u,function(e,t){try{switch(t){case"address":a+=i.data.street_number+" "+i.data.route;break;case"street":a+=i.data.route;break;case"street-long":a+=i.data.route_long;break;case"city":a+=i.data.locality;break;case"city-state":a+=i.data.locality+r+i.data.administrative_area_level_1;break;case"city-state-zip":a+=i.data.locality+r+i.data.administrative_area_level_1+" "+i.data.postal_code;break;case"state":a+=i.data.administrative_area_level_1;break;case"state-long":a+=i.data.administrative_area_level_1_long;break;case"zip":a+=i.data.postal_code;break;case"county":a+=i.data.administrative_area_level_2;break;case"country":a+=i.data.country;break;case"country-long":a+=i.data.country_long;break}if(u[e+1]!==n){a+=r}}catch(s){}});return a};return r}(jQuery,google.maps)