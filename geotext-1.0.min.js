var GeoText=function(e,t){function n(t){this.vars={name:"default",delimiter:", "};this.data={success:false};if(typeof t!=="undefined"){this.vars=e.extend(this.vars,t)}this.init()}n.prototype.init=function(){var e=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(t){var n=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);(new google.maps.Geocoder).geocode({latLng:n},function(t,n){if(n==google.maps.GeocoderStatus.OK&&typeof t[0]!=="undefined"){e.setLocation(t[0])}})})}};n.prototype.setLocation=function(e){var t=this;t.data.success=true;jQuery.each(e.address_components,function(e,n){jQuery.each(n.types,function(e,r){t.data[r]=n.short_name;t.data[r+"_long"]=n.long_name})});t.applyText()};n.prototype.applyText=function(){var t=this;var n=e("[class*=geotext]");e.each(n,function(n,r){var i=e(r);var s=i.data("geotext-delimiter")?i.data("geotext-delimiter"):t.vars.delimiter;var o=t.parseField(i,s);if(o){if(i.data("geotext-text-before"))o=i.data("geotext-text-before")+o;if(i.data("geotext-text-after"))o=o+i.data("geotext-text-after");if(i.is("input")){i.val(o)}else{i.html(o)}}})};n.prototype.parseField=function(t,n){var r=this;var i=/geotext\[(.*)\]/.exec(t.attr("class"));if(!i)return false;var s=i[1];var o=s.split(/\[|,|\]/);e.each(o,function(e,t){o[e]=t.replace(" ","");if(o[e]==="")delete o[e]});var u="";e.each(o,function(e,t){try{switch(t){case"address":u+=r.data.street_number+" "+r.data.route;break;case"street":u+=r.data.route;break;case"street-long":u+=r.data.route-long;break;case"city":u+=r.data.locality;break;case"city-state":u+=r.data.locality+n+r.data.administrative_area_level_1;break;case"city-state-zip":u+=r.data.locality+n+r.data.administrative_area_level_1+" "+r.data.postal_code;break;case"state":u+=r.data.administrative_area_level_1;break;case"state-long":u+=r.data.administrative_area_level_1_long;break;case"zip":u+=r.data.postal_code;break;case"county":u+=r.data.administrative_area_level_2;break;case"country":u+=r.data.country;break;case"country-long":u+=r.data.country_long;break}if(typeof o[e+1]!=="undefined")u+=n}catch(i){}});return u};return n}(jQuery)